@using TheBlogProject.Services
@model IEnumerable<TheBlogProject.Models.Destination>
@inject IImageService imageService

@{
    ViewData["Title"] = "Destinations";
}

<div class="destination-list">
    <h1>Explore Our Destinations</h1>
    <p>Click on a destination name to view all related blog posts, or directly explore individual posts by clicking the banners below.</p>
<div class="destination-list-index">
    <h1>Explore Our Destinations</h1>
    <p>Click on a destination name to view all related blog posts, or directly explore individual posts by clicking the banners below.</p>

    @if (User.IsInRole("Administrator"))
    {
        <p>
            <a asp-action="Create" class="btn btn-primary">Create New Destination</a>
        </p>
    }

    @foreach (var destination in Model)
    {
        <section class="destination-section-index">
            <!-- Destination Name -->
            <h2 class="destination-name-index">
                <a asp-action="Details" asp-route-slug="@destination.Slug">
                    @destination.Area
                </a>
            </h2>

            <!-- Blog Banners -->
            <div class="blog-banners-index">
                @if (destination.Blogs != null && destination.Blogs.Any())
                {
                    @foreach (var blog in destination.Blogs)
                    {
                        <div class="blog-banner-index">
                            <a asp-controller="Blogs" asp-action="Details" asp-route-slug="@blog.Slug">
                                <div class="banner-image-index" style="background-image: url('@imageService.DecodeImage(blog.ImageData, blog.ContentType)');">
                                    <span class="banner-title-index">@blog.Name</span>
                                </div>
                            </a>
                        </div>
                    }
                }
                else
                {
                    <p>No blogs available for this destination.</p>
                }
            </div>

            <!-- Actions for Edit/Delete -->
            @if (User.IsInRole("Administrator"))
            {
                <div class="destination-actions">
                    <a asp-action="Edit" asp-route-id="@destination.Id" class="btn btn-warning">Edit</a>
                    <a asp-action="Delete" asp-route-id="@destination.Id" class="btn btn-danger">Delete</a>
                </div>
            }
        </section>
    }
</div>